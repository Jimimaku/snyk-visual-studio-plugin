namespace Snyk.VisualStudio.Extension.UI.Tree

{
    /// <summary>
    /// Open source root node for vulnerability tree.
    /// </summary>
    public class RootVulnerabilityTreeNode : VulnerabilityTreeNode
    {
        /// <summary>
        /// Title text for open source root node.
        /// </summary>
        public const string OpenSourceSecurityTitle = "Open Source Security";

        /// <summary>
        /// Title text template for open source vulnerabilites, with count of all issues and information by severity.
        /// </summary>
        public const string OpenSourceSecurityDetailsTitle = "Open Source Security - {0} vulnerabilities: {1} critical | {2} high | {3} medium | {4} low";

        /// <summary>
        /// Initializes a new instance of the <see cref="RootVulnerabilityTreeNode"/> class.
        /// </summary>
        public RootVulnerabilityTreeNode() => this.Title = OpenSourceSecurityTitle;

        /// <summary>
        /// Gets a value indicating whether icon for open source node.
        /// </summary>
        public override string Icon => SnykIconProvider.OpenSourceSecurityIconPath;

        /// <summary>
        /// Set detailed title (with information by severity).
        /// </summary>
        /// <param name="vulnerabilitiesCount">Total vulnerabilities count.</param>
        /// <param name="criticalSeverityCount">Total vulnerabilities with critical severity.</param>
        /// <param name="highSeverityCount">Total vulnerabilities with high severity.</param>
        /// <param name="mediumSeverityCount">Total vulnerabilities with medium severity.</param>
        /// <param name="lowSeverityCount">Total vulnerabilities with low severity.</param>
        public void SetDetailsTitle(
            int vulnerabilitiesCount,
            int criticalSeverityCount,
            int highSeverityCount,
            int mediumSeverityCount,
            int lowSeverityCount) =>
            this.Title = string.Format(OpenSourceSecurityDetailsTitle, vulnerabilitiesCount, criticalSeverityCount, highSeverityCount, mediumSeverityCount, lowSeverityCount);

        /// <summary>
        /// Clear all items in this node and title.
        /// </summary>
        public void Clean()
        {
            this.Items.Clear();

            this.Title = OpenSourceSecurityTitle;
        }
    }
}
